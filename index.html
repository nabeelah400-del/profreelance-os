<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PROFREELANCE OS CONTROL PANEL</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

:root{

--bg:#05070f;
--card:rgba(255,255,255,0.06);
--stroke:rgba(255,255,255,0.1);
--teal:#14b8a6;

}

body{

margin:0;
padding:40px;
background:var(--bg);
color:white;
font-family:system-ui;

}

h1{

font-size:48px;
margin-bottom:10px;

}

.status{

float:right;
margin-top:-60px;
background:rgba(255,255,255,0.05);
padding:10px 20px;
border-radius:30px;

}

.grid{

display:grid;
grid-template-columns:repeat(3,1fr);
gap:20px;
margin-top:40px;

}

.card{

background:var(--card);
padding:25px;
border-radius:20px;
border:1px solid var(--stroke);

}

.metric{

font-size:48px;
color:var(--teal);

}

canvas{

margin-top:40px;

}

.list{

margin-top:20px;

}

.item{

background:var(--card);
padding:15px;
margin-bottom:10px;
border-radius:15px;

}

</style>

</head>

<body>

<h1>PROFREELANCE OS</h1>

<div class="status">

<span id="status">Connecting...</span>

</div>

<div class="grid">

<div class="card">

Revenue

<div id="revenue" class="metric">—</div>

</div>

<div class="card">

Active Clients

<div id="clients" class="metric">—</div>

</div>

<div class="card">

Pipeline Value

<div id="pipeline" class="metric">—</div>

</div>

</div>

<canvas id="chart"></canvas>

<h2>Pipeline</h2>

<div id="pipelineList" class="list"></div>

<h2>Activity</h2>

<div id="activityList" class="list"></div>

<script>


const CSV_METRICS="https://docs.google.com/spreadsheets/d/e/2PACX-1vQPgSVSxvqDb3ZT4xfOdWvS7L2femGi-QM_S7yG72TkFYj7RTvRcRIakEnnpfgOXEStak3Q72Q0YBGB/pub?gid=44313312&single=true&output=csv";

const CSV_SIGNAL="https://docs.google.com/spreadsheets/d/e/2PACX-1vQPgSVSxvqDb3ZT4xfOdWvS7L2femGi-QM_S7yG72TkFYj7RTvRcRIakEnnpfgOXEStak3Q72Q0YBGB/pub?gid=584175548&single=true&output=csv";

const CSV_PIPELINE="https://docs.google.com/spreadsheets/d/e/2PACX-1vQPgSVSxvqDb3ZT4xfOdWvS7L2femGi-QM_S7yG72TkFYj7RTvRcRIakEnnpfgOXEStak3Q72Q0YBGB/pub?gid=182871929&single=true&output=csv";

const CSV_ACTIVITY="https://docs.google.com/spreadsheets/d/e/2PACX-1vQPgSVSxvqDb3ZT4xfOdWvS7L2femGi-QM_S7yG72TkFYj7RTvRcRIakEnnpfgOXEStak3Q72Q0YBGB/pub?gid=64013084&single=true&output=csv";



function formatMoney(n){

return "R"+Number(n).toLocaleString()

}



function parseCSV(text){

return text.trim().split("\n").map(r=>r.split(","))

}



async function loadMetrics(){

const text=await fetch(CSV_METRICS).then(r=>r.text())

const rows=parseCSV(text)

document.getElementById("revenue").innerText=formatMoney(rows[1][1])

document.getElementById("clients").innerText=rows[2][1]

document.getElementById("pipeline").innerText=formatMoney(rows[3][1])

}



async function loadSignal(){

const text=await fetch(CSV_SIGNAL).then(r=>r.text())

const rows=parseCSV(text)

const labels=[]

const revenue=[]

const pipeline=[]

for(let i=1;i<rows.length;i++){

labels.push(rows[i][0])

revenue.push(rows[i][1])

pipeline.push(rows[i][2])

}

new Chart(document.getElementById("chart"),{

type:"line",

data:{

labels:labels,

datasets:[

{

label:"Revenue",

data:revenue,

borderColor:"#14b8a6"

},

{

label:"Pipeline",

data:pipeline,

borderColor:"#00ffd0"

}

]

}

})

}



async function loadPipeline(){

const text=await fetch(CSV_PIPELINE).then(r=>r.text())

const rows=parseCSV(text)

const el=document.getElementById("pipelineList")

el.innerHTML=""

for(let i=1;i<rows.length;i++){

el.innerHTML+=`<div class="item">

${rows[i][0]} - R${rows[i][1]}

</div>`

}

}



async function loadActivity(){

const text=await fetch(CSV_ACTIVITY).then(r=>r.text())

const rows=parseCSV(text)

const el=document.getElementById("activityList")

el.innerHTML=""

for(let i=1;i<rows.length;i++){

el.innerHTML+=`<div class="item">

${rows[i][0]} - ${rows[i][1]}

</div>`

}

}



async function refresh(){

try{

await loadMetrics()

await loadSignal()

await loadPipeline()

await loadActivity()

document.getElementById("status").innerText="Connected"

}

catch{

document.getElementById("status").innerText="Error"

}

}



refresh()

setInterval(refresh,30000)

</script>

</body>

</html>
